{% extends "app.html" %}

{% block app_content %}
<div class="row">
  <div class="col-md-12">

<div class="jumbotron">
<div class="media">
  <div class="media-body">
    <h4 class="media-heading">Con·bench</h4>
     <h4>/kənˈben(t)SH/</h4>
     <h5><i>noun</i></h5>
     <h3>Language-independent Continuous Benchmarking (CB) Framework</h3>
  </div>
  <div class="media-right">
     <img class="media-object" style="padding: 5px" src="{{ url_for('static', filename='bar-graph.png') }}" height="150">
  </div>
</div>
</div>

  </div>
</div>


<div class="row">
    <div class="col-md-12">
        <table id="runs" class="table table-striped table-bordered table-hover">
          <caption>Runs
          </caption>
            <thead>
                <tr>
                    <th scope="col">Run creation time</th>
                    <th scope="col" class="author-col" style="width: 195px">Commit author</th>
                    <th scope="col">Repository</th>
                    <th scope="col">Hardware</th>
                    <th scope="col" class="commit-col" style="width: 65px">Commit</th>
                    <th scope="col" style="width: 150px">Commit message</th>
                    <th scope="col" class="reason-col" style="width: 80px">Reason</th>
                </tr>
            </thead>
            <tbody>
                {% for run in runs %}
                <tr>
                     <td style="white-space: nowrap;">
                         {% if run.has_errors or run.error_info %}
                             <i class="glyphicon glyphicon-exclamation-sign text-danger"
                                data-toggle="tooltip"
                                data-placement="top"
                                title="Run or some benchmarks have errors"></i>
                         {% else %}
                            <i class="glyphicon glyphicon-ok-circle text-success"></i>
                         {% endif %}
                         <a href="{{ url_for('app.run', run_id=run.id) }}">{{ run.display_timestamp }}</a>
                     </td>

                     <td>
                         <div class="table-entry">
                       {% if run.commit.author_avatar %}
                         <img src="{{ run.commit.author_avatar }}" height="30" style="border-radius: 50%;">&nbsp;
                       {% endif %}
                       {{ run.commit.author_name }}
                         </div>
                     </td>

                    <td>
                         <div class="table-entry">
                             <a href="{{ run.commit.repository }}">{{ run.commit.display_repository }}</a>
                         </div>
                    </td>

                    <td>
                         <div class="table-entry">{{ run.hardware.name }}</div>
                    </td>
                    <td>
                         <div class="table-entry">
                             <!--NOTE: enables full commit SHA search while maintaining partial SHA display for UI -->
                             <a href="{{ run.commit.url }}"> {{ run.commit.sha[:7] }}
                             <p class="hide-text">{{ run.commit.sha }}</p>
                         </a>
                         </div>
                    </td>

                    <td>
                         {% if run.commit.display_message %}
                            <div class="table-entry">{{ run.commit.display_message }}</div>
                         {% else %}
                            <div class="table-entry"></div>
                         {% endif %}
                    </td>

                    <td>
                         {% if run.reason %}
                           <div class="table-entry">{{ run.reason }}</div>
                         {% else %}
                           <div class="table-entry"></div>
                         {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="row">
  <div class="col-md-12">
    <br>
    <div align="right" style="display:inline-block; float: right; color: #C0C0C0;">
       Conbench {{ version }}
    </div>
  </div>
</div>

{% endblock %}


{% block scripts %}
{{super()}}
<script type="text/javascript">
  var table = $('#runs').DataTable({
      "order": [[0, 'desc']],
      // Make "Commit" (commit hash) column (4) more narrow, hide 'sorting'
      // toggle. Sorting by commit hash is not needed, in particular because
      // one can filter by commit hash via input field. Do the same for the
      // "Commit author" column (1), and the "Commit message" columnn (5).
      // First column has index 0.
      "columnDefs": [{ "orderable": false, "targets": [1, 4, 5] }],
      "language": {
          "searchPlaceholder": "commit hash works too",
      },
});


enable_search_query_string('#runs');

/* specify the HTML table id (string) for
 which search functionality should be enabled
*/
column_search_implementation('#runs');

</script>
{% endblock %}
